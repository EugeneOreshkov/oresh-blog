{% extends "base.html" %}
{% block content %}
    <table>
        <tr valign="top">
        <td><img src="{{ user.avatar(128) }}"></td>
        <td>
            <h1>Пользователь: {{ user.username }}</h1>
            {% if user.about %}<p>{{ user.about }}</p>{% endif %}
            {% if user.created_at %}<p>Создан: {{ user.created_at }}</p>{% endif %}
            {% if user.last_login %}<p>Последний вход: {{ user.last_login }}</p>{% endif %}
            <p>Постов: {{ user.posts_count() }}</p>
            <p>Подписчиков: {{ user.followers_count() }}</p>
            <p>Подписок: {{ user.following_count() }}</p>
            {% if current_user.is_authenticated and current_user.id == user.id %}
                <p><a href="{{ url_for('profile.edit_profile') }}">Edit Profile</a></p>
            {% elif current_user.is_authenticated and not current_user.is_following(user) %}
                <form action="{{ url_for('users.follow_user', username=user.username) }}" method="post">
                    {{ form.hidden_tag() }}
                    <button type="submit" class="btn btn-primary">Подписаться</button>
                </form>
            {% elif current_user.is_authenticated and current_user.is_following(user) %}
                <form action="{{ url_for('users.unfollow_user', username=user.username) }}" method="post">
                    {{ form.hidden_tag() }}
                    <button type="submit" class="btn btn-secondary">Отписаться</button>
                </form>
            {% endif %}
        </td>
        </tr>
    </table>    
    {% for post in posts %}
        {% include "partials/_post.html" %}
    {% endfor %}
    {% if prev_url %}
    <a href="{{ prev_url }}">Вернуться назад</a>
    {% endif %}
    {% if next_url %}
    <a href="{{ next_url }}">Показать ещё</a>
    {% endif %}
{% endblock %}
